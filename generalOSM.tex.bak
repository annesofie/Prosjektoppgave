\chapter{Characteristics of Open Street Map}

\section{General}
The OpenStreetMap project is one of the most impressive projects of Volunteered Geographic Information on the Internet\cite{Neis2012}. Until recent the mapping of the Earth was preserved highly skilled, well-equipped and organized individuals and groups. One important happening was in 2000 when Bill Clinton removed the selective availability of the GPS signal \ref{sec:weber}. This change improved the accuracy of simpler, cheaper GPS receivers so that also ordinary people could start mapping their movements. OpenStreetMap was founded in 2004 at University College London by Steve Coast. The goal was to create a free database with geographic information of the world \cite{Neis2012}. Back in 2004, the geographic data was expensive and hard to get access to. 

The OSM project stands out from other data sources mainly because it's free to use and released under a license that allows for pretty much whatever the user wants to as long as the user mention the original creator and the licence\cite{Chilton}.  The most common contribution approach is to record data using a GPS receiver and edit the data using one of the free and available OSM editors \cite{Neis2012}.  

One of the reasons for OpenStreetMap's success is that today the world has a need for instant information, particularly in crisis situations \cite{Chilton}. Here OpenStreetMap is the leading global example of the effectiveness of crowdsourcing of geodata. Crowdsourced geographic data has characteristics or advantages of large data volume, high currency, large quantity of information and low cost \cite{Wang2013}. The project is changing the way individuals and organizations are thinking about the collection process, purchase and use of geodata \cite{Chilton}.  

%\section{Culture}
%OSMhas no notability rule, an arbitrary amount of detail is possible, but somebody has to maintain it! %https://www.youtube.com/watch?v=KNTSZGnQVRw

\section{Data structure}
OpenStreetMap uses a topological data structure. This structure includes three basic components nodes, ways, and relations. Nodes are points with a geographic position stored as coordinates (Lat, long) according to WGS84. Ways are lists of two or more nodes, representing an open- or closed way used to describe streets, rivers, among others \cite{Debruyne2015}. A relation is a multi-purpose data structure that documents a relation between two or more components \cite{OpenStreetMapg}. OpenStreetMap's structure uses tags to add metadata to geographic objects. Tags consist of two items, a key and a value of the form key=value. The key is used to describe the topic, category or type of feature, while the value represents the details of the particular form of the key specified. An example of a key-value pair can be building=church, here the key is building and the value is a church, this is a building that was built as a church. 

OpenStreetMap does not have any restrictions on tags assigned to nodes, ways or relations, and mappers can use any key-value pair in their import. Nevertheless, the norm in OSM is to try to map new data with existing tags. Good practice is to search for tags, or map features, on different OSM wiki-sites. On the \textit{tags you like} wiki page they recommend different sites, but points out \textit{taginfo.openstreetmap.org} as the most useful site. Taginfo is a website created for finding and aggregating information about OSM tags, it covers the whole planet and is updated daily. The web page list tags used in the database and also inform on how often they have been used.* %How frequent they appear insted?
 Taginfo also lists other tags which have been used in combination with the displayed tag. Some countries also have their own taginfo web pages, like Ireland, Great-Britain, and France, Norway does not have it. If a mapper doesn't find an appropriate key-value pair and wants to create a new feature, this has to be documented on the OSM wiki page. 

In OSM, changes made by one user over a short period is called a changeset \cite{OpenStreetMapi}.  Change can be a creation of new components, adding tags to existing components, changes to tags in existing components, removal of tags and removal of components. Changes are added to the changeset as long as it's open, changesets are either closed directly or by itself after a period of inactivity (currently after one hour). Every component in the OSM database is a part of a changeset.* %Hvert element i OSM databasen er en del av et changeset, skrive om?

\section{Organization}
%Redgj√∏re for hva OSM er og hvordan det fungerer teknisk og organisatorisk
The OpenStreetMap Project is supported by the OpenStreeMap Foundation (OSMF) which is a UK-registered non-profit organization. OSMF was founded in 2006 and consists of members from all over the world, as of December 2015 consist of 350 normal-, 351 associate- and 18 corporate members \cite{OSMF2015}. OSMF include a board of seven members and is critical to the ongoing function and growth of the OpenStreetMap project \cite{OSMF}.  The foundation has the responsibility for the servers and services necessary for hosting the OSM project. They also support and communicates with the working groups, and delegates important tasks like web page development, etc. 

A person can contribute to the OSM project without being a member of the foundation. The project has over 3 million registered users, and around 40 000 active users each month \cite{ OSMstats2016} collecting, updating and editing the data. The crowdsourced data are then released under the Open Database License, \textit{"a license agreement intended to allow users to freely share, modify, and use this Database while maintaining this same freedom for others"} \cite{ODbL}.  Users can edit maps through different tools made by OSM developers. One tool is called iD and is the default web browser editor created by MapBox. There are also desktop editing applications like JOSM and Merkaartor which are more powerful and better suited for advanced users. 

Communication is done through channels like mailing lists, wiki pages, conferences and GitHub repositories. In the public mailing lists, everyone who subscribes to it is overhearing every conversation. Overhearing conversations through mailing lists is described as broadcast communication in the Gutwin paper from 2004 \cite{Gutwin2004}. The ability to speak to an expected audience rather than one individual has several advantages. Allowing people to decide for themselves whether to respond or not and as the conversation develops new people can join. In OpenStreetMap there are over 150 mailing lists \cite{Reiter2016}, keeping an overview of everything is impossible. That is why weeklyOSM was created in 2010 and is a collection of news relevant to the OSM community written in 5 different languages \cite{Freyfogle2016}.  In State of the Map 2016 conference, the WeeklyOSM team won the Influential Writing Award, nominated and voted by the community [OpenStreetMap, 2016a]. A good evidence of how important their work is to the community. State of the Map is the main OSM conference, organized by OSMF and has been held each year since 2007 \cite{OpenStreetMapj}. Important communication is also done through both issues and pull requests in the repositories at the OpenStreetMap GitHub channel. 

 \section{File format, .osm files}
The .osm file format is specific to OpenStreetMap, and it is not easy to open these files using GIS-software like QGIS. The file format is designed to be easily sent and received across the Internet in a standard format. Therefore .osm files are easily obtained, but using the files directly for analyzing and map design is not easy. The .osm files are coded in the XML format. It is recommended to convert the data into other formats when using the files \cite{Learnosm}. 

Points are represented as nodes, lines as ways and areas as a relation in .osm files. Each represented by a tag: <node>, <way> and <relation>. Node is one of the core elements in the OSM data model. A node-tag consists of a single point defined by node-id, latitude, and longitude. When nodes are used on their own, which means that they are not included in a way or a relation, they represent point features. Points features normally include at least one tag to define the points purpose \cite{OpenStreetMapc}. In listing \ref{eq:nodetag} the node tag describes a bag shop named Citybag, this is called a point of interest. The user key's value is the name of who last modified this node (user="Peter Bremer") and uid are the person's numeric user id (uid="366321"). * %Litt for tung setning?

\lstset{
    language=XML,
    morekeywords={encoding,node, tag},
    label=eq:nodetag,
    caption=Example of a node tag
}
\begin{lstlisting}
 <node id="4004323486" visible="true" version="1" changeset="37189343"
  timestamp="2016-02-13T15:58:54Z" user="Peter Bremer" uid="366321" 
  lat="63.4318129" lon="10.3971411">
  <tag k="name" v="Citybag"/>
  <tag k="shop" v="bag"/>
 </node>
\end{lstlisting}

A way-tag consists of two or more nodes and can either be open or closed. An open way describes a line feature that does not share the first and last node. Examples of features are roads, cycleway, and streams. When a way is closed the first and last nodes are the same and can be interpreted as a closed polyline or an area, or both \cite{OpenStreetMapd}. A closed way with highway=* tag can represent roundabouts, or if it has amenity=school tag the closed way represent the outline of a school. In listing \ref{eq:waytag1} the way describes a building outline since the key equals building and the value equals church.  The building in listing \ref{eq:waytag1} is the footprint of a church. The <nd> tag represents a node, where the <nd> tags refers to <node> tags who contains the lat, long values. All <nd> tags create the building footprint, notice that there is no height parameter. Listing \ref{eq:waytag1} creates a 2D representation of the church which is shown in figure \ref{fig:fruekirke2D}. A 3D representation of the same church is shown in figure \ref{fig:fruekirke}.

\lstset{
    language=XML,
    morekeywords={encoding, relation, way, tag, node, member},
    label=eq:waytag1,
    caption=Example of a way tag - creating the building footprint
}
\begin{lstlisting}
 <way id="89340594" visible="true" version="6" changeset="42571811" 
  timestamp="2016-10-01T22:11:17Z" user="Peter Bremer" uid="366321">
  <nd ref="1036369169"/>
  <nd ref="1036369134"/>
  <nd ref="1036369111"/>
  <nd ref="1036369185"/>
  <nd ref="1036369163"/>
  <nd ref="1036369118"/>
  <nd ref="1036369099"/>
  <nd ref="4427055078"/>
  <nd ref="1036369179"/>
  <nd ref="1036369158"/>
  <nd ref="4427055082"/>
  <nd ref="1036369145"/>
  <nd ref="1036369124"/>
  <nd ref="1036369103"/>
  <nd ref="4215548739"/>
  <nd ref="4215548736"/>
  <nd ref="4215548737"/>
  <nd ref="4215548740"/>
  <nd ref="1036369182"/>
  <nd ref="1036369140"/>
  <nd ref="1036369115"/>
  <nd ref="1036369096"/>
  <nd ref="1036369135"/>
  <nd ref="1036369149"/>
  <nd ref="4427055803"/>
  <nd ref="1036369131"/>
  <nd ref="1036369107"/>
  <nd ref="1036369169"/>
  <tag k="amenity" v="place_of_worship"/>
  <tag k="building" v="church"/>
  <tag k="denomination" v="protestant"/>
  <tag k="name" v="V√•r Frue kirke"/>
  <tag k="religion" v="christian"/>
  <tag k="wheelchair" v="yes"/>
  <tag k="wikidata" v="Q3356455"/>
  <tag k="wikipedia" v="en:V√•r Frue Church"/>
 </way>
\end{lstlisting}

\begin{figure}[H]
    \centering
    \includegraphics[scale=0.5]{figures/FixedByMe/fruekirke2D.png}
    \caption{2D representation of \textit{Vaar frues kirke}, source: openstreetmap.org}
    \label{fig:fruekirke2D}
\end{figure}

A relation is an ordered list of one or more nodes, ways, and/or relations and is used to define logical or geographical relationships between the other elements \cite{OpenStreetMape}. If a building consists of multiple parts, tagged with building:part=*, a relation is used to define the geographical relationship between the parts. Specifying roles to different parts is possible. A road can have role as east, going towards east. In multi-polygons, parts can have an inner or outer role, to specify whether it forms the inner or outer part of the polygon. A building relation is shown in listing \ref{eq:reltag}. There are eight members in this relation. The first member is a way, and it has an outline role creating the building footprint, for 2D representation. Listing \ref{eq:waytag1} is the XML-code for this way (notice that the ref number are equal to the way id in listing \ref{eq:waytag1}). The only node member in the relation contains the church's address. The rest of the members creates the 3D representation of the building shown in figure \ref{fig:fruekirke}.

\lstset{
    language=XML,
    morekeywords={encoding, relation, way, tag, node, member},
    label=eq:reltag,
    caption=Example of a relation tag
}
\begin{lstlisting}
 <relation id="6269954" visible="true" version="2" changeset="39708156" 
  timestamp="2016-06-01T11:14:18Z" user="Peter Bremer" uid="366321">
  <member type="way" ref="89340594" role="outline"/>
  <member type="node" ref="2957446972" role=""/>
  <member type="way" ref="421821942" role=""/>
  <member type="way" ref="421821938" role=""/>
  <member type="way" ref="421821939" role=""/>
  <member type="way" ref="421821940" role=""/>
  <member type="way" ref="421821937" role=""/>
  <member type="way" ref="421821941" role=""/>
  <tag k="name" v="V√•r Frue kirke"/>
  <tag k="type" v="building"/>
 </relation>
\end{lstlisting}

\begin{figure}[H]
    \centering
    \includegraphics[scale=0.5]{figures/FixedByMe/fruekirke.png}
    \caption{3D representation of \textit{Vaar frues kirke}, source: osmbuildings.org}
    \label{fig:fruekirke}
\end{figure}


 \section{Mapping buildings in OSM}\label{buildOSM}
When importing buildings into OSM, the XML-code representing the building must be tagged with Building=*. This buildings key is used to mark areas as buildings, the * value varies. Frequent occurring values are house, residential and garage, describing the buildings particular usage. The most common occurring value to the building key is yes and used when it's not possible to determine a more accurate value \cite{OpenStreetMapf}. A list of possible values that can be added to the building key is listed on the OSM building wiki page. It is possible to introduce new values, but it is not recommended. Additional attributes often used together with the building key is entrance, height of the building, building levels and address \cite{Unkn} . The building key is most common used in way representations. For an example of how to use building key in a way-tag see listing \ref{eq:waytag1}.

A building can be represented by nodes, ways or relations. Using the building tag on nodes is tolerated but not recommended. A building is much better expressed by their footprint (close way or multi-polygon), and if the footprint is available, one should not add building tag in nodes. It is most common to represent buildings through ways \cite{OpenStreetMapf}. A building can also be described with a relation. Relations are used if the building consists of multiple parts which physical differ from each other, often when a 3D representation of the building is created. A building relation mainly consists of two or more ways. A way then represents a part of the building and should be tagged with a building:part key and usually the value yes. Then the way-tags representing the different building parts are ordered together inside the relation. An example of a building:part=yes implementation can be seen in listing \ref{eq:waytag}. Note that the first and last <nd> tag refers to the same node, so this is a closed way. The key roof:shape with value gable gives the appearance of the roof. The result from the code in listing \ref{eq:waytag} is shown in figure \ref{fig:erkeinng} marked with a red line. A relation containing building:parts are shown in listing \ref{eq:reltag}. Notice that this relation is tagged with the key type and the value building. If a relation is tagged with type=building, it groups both building footprint and all building parts together. See figure \ref{fig:fruekirke} for a 3D building representation created with building parts. 

\lstset{
    language=XML,
    morekeywords={encoding,way, tag, nd},
    label=eq:waytag,
    caption=Example of a way tag
}
\begin{lstlisting}
  <way id="17533469" visible="true" version="22" changeset="39301425" 
  timestamp="2016-05-13T21:20:04Z" user="Peter Bremer" uid="366321">
  <nd ref="3505716655"/>
  <nd ref="2517225923"/>
  <nd ref="4184346715"/>
  <nd ref="3505716656"/>
  <nd ref="4184346713"/>
  <nd ref="4184346717"/>
  <nd ref="3505716654"/>
  <nd ref="4184346719"/>
  <nd ref="3505716655"/>
  <tag k="building:colour" v="#c3c0b9"/>
  <tag k="building:material" v="stone"/>
  <tag k="building:part" v="yes"/>
  <tag k="height" v="11"/>
  <tag k="name" v="Sydkapell"/>
  <tag k="roof:height" v="4"/>
  <tag k="roof:material" v="copper"/>
  <tag k="roof:orientation" v="across"/>
  <tag k="roof:shape" v="gabled"/>
 </way>
\end{lstlisting}

\begin{figure}[H]
    \centering
    \includegraphics[scale=0.5]{figures/FixedByMe/nidaros3D.png}
    \caption{\textit{Sydkapell} with gabled shaped roof, source: osmbuildings.org}
    \label{fig:erkeinng}
\end{figure} 